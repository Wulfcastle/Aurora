<!DOCTYPE html>
 <html>

 <head>
<!-- Original URL: https://www.mapbox.com/bites/00058/
Date Downloaded: 2014-12-05 09:27:49 PM !-->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     <meta charset="utf-8" />
     <title>Smart Directions Demo </title>
     <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
     <script src='../../../api.tiles.mapbox.com/mapbox.js/v1.6.2/mapbox.js'></script>
     <link href='../../../api.tiles.mapbox.com/mapbox.js/v1.6.2/mapbox.css' rel='stylesheet' />
     <link href='../../base/latest/base.css' rel='stylesheet' />
     <script src='../../../code.jquery.com/jquery-2.0.3.min.js'></script>
     <style>
    body {
        margin:0;
        padding:0;
    }
    #map {
        position:absolute;
        top:0;
        bottom:0;
        width:100%;
    }
    .text {
        top: 20px;
        right: 20px;
        z-index: 100;
        width: 350px;
    }
    .text .smart {
        color:#39abc7;
    }
    .text .regular {
        color:#8586c5;
    }
    .leaflet-clickable {
        cursor: pointer;
    }
    .hint {
        top: 170px;
        right: 0;
        width: 350px;
        left: 0;
        margin-left: auto;
        margin-right: auto;
        z-index: 200;
    }
    .hint a  {
        top: 10px;
        right: 10px;
    }
    .hint.offcanvas-right {
        right: 0px;
        margin-right: 0;
    }

    @media only screen and (max-width: 834px) {
        .text { width: 295px; }
        .text span { display: none; }
        .logo-wrap { display: none;}
        .text h2 { font-size: 15px; padding: 0;}
    }
    @media only screen and (max-width: 640px) {
        .pad2 { padding: 20px; }
    }
    </style>
 </head>

 <body class='clip'><div style="z-index: 9999; position: fixed; width: 100%; border: 0px; padding: 5px; margin: 0px; background-color: transparent;  font-size: 12pt; font-family: sans-serif;" id="web2disk_nag" onclick="javascript: document.getElementById('web2disk_nag').style.display = 'none';">
		<div style="color: #000000; background-color:#F1F1F1; margin-left: auto; margin-right: auto; border-width: 2px; border-style: solid; width: 550px; ">
			<div style="width: 100%; text-align: center; font-weight: bold; border: 0px; margin: 0px; padding: 0px">Hey, where did my words go? (Click to hide)</div>
			<p>In the trial version of Web2Disk every fifth word is blanked out. 
			To copy this site with all the words, please upgrade to the full version and copy this website again.</p>
			<div style="width: 100%; text-align: center; font-weight: bold; border: 0px; margin: 0px; padding: 0px">
				<a href="http://www.inspyder.com/products/Web2Disk/">Inspyder Web2Disk: The Website Downloader</a>
			</div>
		</div>
	</div>
     <div id='map'></div>
     <div class="round-left clip pin-topright fill-white text">
       
         <div class='pad2 keyline-bottom'>
             <h3 class='smart'>Smart Directions </h3>
             <span class='quiet small'>Optimized for efficient scooter ______. </span>
         </div>
         <div class='pad2'>
             <h3 class='regular'>Default Directions </h3>
             <span class='quiet small'>Optimized for car driving _____. </span>
         </div>
     </div>
     <div class='class="round-left hint animate pin-topright pad4 fill-midnight dark center round"'>
     <h2 class='smart space-bottom0'>Try it yourself </h2>
    _____ the map to start _ route. <a href='#' class='icon quiet button pad1 pin-right close'></a></div>
     <script type='text/javascript'>
    var numberOfClicks = 0;
    var isFirstRoute = true;
    var startOfRoute;
    var endOfRoute;
    var startMarker = L.layerGroup();
    var endMarker = L.layerGroup();
    var noHillsRoute = L.layerGroup();
    var hasHillsRoute = L.layerGroup();
    var map = L.mapbox.map('map', 'tatiana.88a1b6d9', {
        tileLayer: {
            detectRetina: true
        }
    }).setView([37.765761783370465,-122.4012565612793], 13);
    map.scrollWheelZoom.disable();

    map.on('click', function(e) {

        $('.hint').addClass('offcanvas-right');

        if (numberOfClicks == 0) {
            endMarker.clearLayers();
            startMarker.clearLayers();
            hasHillsRoute.clearLayers();
            noHillsRoute.clearLayers();
        }
        numberOfClicks++
        if (numberOfClicks == 1) {
            startOfRoute = e.latlng;
            L.marker(e.latlng, {
                draggable: true,
                icon: L.mapbox.marker.icon({
                    'marker-size': 'medium',
                    'marker-color': '#47A1DD',
                    'marker-symbol': 'a'
                })
            }).addTo(startMarker).on('dragend', function(p) {
                startOfRoute = p.target._latlng
                routeBetweenLocations(p.target._latlng, endOfRoute, false);
                routeBetweenLocations(p.target._latlng, endOfRoute, true);
            });
            map.addLayer(startMarker)
        }
        if (numberOfClicks == 2) {
            endOfRoute = e.latlng;
            routeBetweenLocations(startOfRoute, endOfRoute, false);
            routeBetweenLocations(startOfRoute, endOfRoute, true);
            L.marker(e.latlng, {
                draggable: true,
                icon: L.mapbox.marker.icon({
                    'marker-size': 'medium',
                    'marker-color': '#47A1DD',
                    'marker-symbol': 'b'
                })
            }).addTo(endMarker).addTo(startMarker).on('dragend', function(p) {
                endOfRoute = p.target._latlng
                routeBetweenLocations(startOfRoute, p.target._latlng, false);
                routeBetweenLocations(startOfRoute, p.target._latlng, true);
            });;
            map.addLayer(endMarker);
            numberOfClicks = 0;
        }
    });

    function routeBetweenLocations(locationOne, locationTwo, noHills) {
        if (noHills) {
            var url = 'https://api.tiles.mapbox.com/v3/scoottech.map-7susygol/directions/driving/' + locationOne.lng + ',' + locationOne.lat + ';' + locationTwo.lng + ',' + locationTwo.lat + '.json?geometry=geojson';
            noHillsRoute.clearLayers();
        } else {
            var url = 'https://api.tiles.mapbox.com/v3/bobbysud.map-l4i2m7nd/directions/driving/' + locationOne.lng + ',' + locationOne.lat + ';' + locationTwo.lng + ',' + locationTwo.lat + '.json?geometry=geojson';
            hasHillsRoute.clearLayers();
        }
        $.ajax({
            type: 'GET',
            dataType: 'json',
            url: url,
            cache: true, // browser cache these values
            success: function(e) {
                var line = [];
                if (e.routes.length > 0) {
                    for (var i = 0; i < e.routes[0].geometry.coordinates.length; i++) {
                        line.push([e.routes[0].geometry.coordinates[i][1], e.routes[0].geometry.coordinates[i][0]]);
                        if (e.routes[0].geometry.coordinates.length - 1 == i) {
                            if (!noHills) {
                                var polyline_options = {
                                    color: '#8586c5',
                                    weight: 4,
                                    opacity: 1,
                                    dashArray: '3,6'
                                };
                            } else {
                                var polyline_options = {
                                    color: '#39abc7',
                                    weight: 4,
                                    opacity: 1,
                                };
                                if(!isFirstRoute){
                                    map.panTo(L.latLngBounds(line).getCenter());
                                }
                                isFirstRoute = false
                            }
                            var polyline = L.polyline(line, polyline_options).addTo(noHillsRoute);
                            map.addLayer(noHillsRoute);
                        }
                    }
                }
            },
            error: function(e) {
                console.log(e)
            }
        });
    }

    $('.hint a').on('click', function() {
        $(this).parent('div').addClass('offcanvas-right');
    });

    map.fireEvent('click',{latlng:{lat:37.78699608830537, lng: -122.43249893188477}});
    map.fireEvent('click',{latlng:{lat: 37.74492860152247, lng: -122.40520477294922}});
    $('.hint').removeClass('offcanvas-right');

    </script>
 </body>

 </html>
 